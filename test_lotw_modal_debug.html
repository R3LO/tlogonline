<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ LoTW</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>–¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ LoTW</h1>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <button type="button" class="btn btn-primary" onclick="testModal()">
            –¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        </button>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π -->
        <button type="button" class="btn btn-secondary" onclick="checkFunctions()">
            –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
        </button>
        
        <div id="debug-info" class="mt-4 p-3 bg-light border">
            <h5>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç–ª–∞–¥–∫–∏:</h5>
            <div id="debug-output"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–∑ lotw.html -->
    <div class="modal fade" id="viewQSOModalLotw" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        üìã –î–µ—Ç–∞–ª–∏ QSO (LoTW)
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-3">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="card border-primary h-100">
                                <div class="card-header bg-primary text-white py-2">
                                    <h6 class="mb-0">üìä –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h6>
                                </div>
                                <div class="card-body p-3">
                                    <div class="row g-2 small">
                                        <div class="col-5 text-muted">üÜî ID QSO:</div>
                                        <div class="col-7"><span id="view_id" class="badge bg-dark text-light">-</span></div>
                                        <div class="col-5 text-muted">üìÖ –î–∞—Ç–∞:</div>
                                        <div class="col-7"><span id="view_date">-</span></div>
                                        <div class="col-5 text-muted">üïê –í—Ä–µ–º—è:</div>
                                        <div class="col-7"><span id="view_time">-</span></div>
                                        <div class="col-5 text-muted">üë§ –ú–æ–π –ø–æ–∑—ã–≤–Ω–æ–π:</div>
                                        <div class="col-7"><span id="view_my_callsign" class="badge bg-primary">-</span></div>
                                        <div class="col-5 text-muted">üì° –ü–æ–∑—ã–≤–Ω–æ–π:</div>
                                        <div class="col-7"><span id="view_callsign" class="badge bg-success">-</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer py-2">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        ‚ùå –ó–∞–∫—Ä—ã—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function debug(msg) {
            document.getElementById('debug-output').innerHTML += `<div>${new Date().toLocaleTimeString()}: ${msg}</div>`;
            console.log(msg);
        }

        function testModal() {
            debug('=== –¢–ï–°–¢ –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê ===');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const modal = document.getElementById('viewQSOModalLotw');
            debug(`–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–π–¥–µ–Ω–æ: ${modal !== null}`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Bootstrap
            debug(`Bootstrap –¥–æ—Å—Ç—É–ø–µ–Ω: ${typeof bootstrap !== 'undefined'}`);
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            const testData = {
                id: 'TEST_123',
                date: '2024-01-01',
                time: '12:00',
                my_callsign: 'MY_CALL',
                callsign: 'TEST_CALL'
            };
            
            Object.keys(testData).forEach(key => {
                const field = document.getElementById(`view_${key}`);
                if (field) {
                    field.textContent = testData[key];
                    debug(`–ü–æ–ª–µ ${key} –∑–∞–ø–æ–ª–Ω–µ–Ω–æ: ${testData[key]}`);
                } else {
                    debug(`–ü–æ–ª–µ ${key} –ù–ï –ù–ê–ô–î–ï–ù–û!`);
                }
            });
            
            if (modal && typeof bootstrap !== 'undefined') {
                try {
                    debug('–°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ...');
                    const bsModal = new bootstrap.Modal(modal);
                    bsModal.show();
                    debug('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∫–∞–∑–∞–Ω–æ!');
                } catch (error) {
                    debug(`–û—à–∏–±–∫–∞: ${error.message}`);
                }
            } else {
                debug('–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ');
            }
        }

        function checkFunctions() {
            debug('=== –ü–†–û–í–ï–†–ö–ê –§–£–ù–ö–¶–ò–ô ===');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            debug(`showQSOModal: ${typeof window.showQSOModal}`);
            debug(`showSimpleModal: ${typeof window.showSimpleModal}`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            const elements = [
                'viewQSOModalLotw',
                'view_id', 
                'view_date',
                'view_time',
                'view_my_callsign',
                'view_callsign'
            ];
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                debug(`–≠–ª–µ–º–µ–Ω—Ç ${id}: ${element !== null ? '–ù–ê–ô–î–ï–ù' : '–ù–ï –ù–ê–ô–î–ï–ù'}`);
            });
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            debug('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            checkFunctions();
        });
    </script>
</body>
</html>